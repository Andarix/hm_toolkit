--ひめしツールキット v1--

作成者：ひめし（Twitter: @himeshi_hob）
初版：2020年11月
対応バージョン：122.0以降（OTRP v28以降）

1. ひめしツールキットとは？
hm_toolkit（ひめしツールキット）は，ワンクリック建設系のスクリプトツールをかんたんに書けるようにするためのライブラリです．アドオン制作におけるdatのような感覚で建設系スクリプトを書けるようになります．

2. ライセンス
MITライセンスとします．
ツール配布の際にhm_toolkit_v1.nutをそのまま同梱して配布していただいて構いません．その際，readme_hm_toolkit.txt（本ファイル）を同梱する必要はありません．

3. 導入方法
ツールのフォルダにhm_toolkit_v1.nutを配置し，tool.nutを専用の書式で記述します．
tool.nutでは，下のようにhm_toolkit_v1をincludeした上で，hm_build()という関数のみ実装します．

include("hm_toolkit_v1") 
function hm_build() {
  //ここに実行したい処理を書く．
}

Simutransのスクリプト記述では本来init()やwork()といった関数を記述しますが，これらはhm_tookitによって全て代行されているので，tool.nutでは実装しないでください．
description.tabは通常のscripting toolと同様に書いてください．

4. 使えるコマンド
ひめしツールキットでは，以下の7種類のコマンドが利用できます．
座標は，ツール実行座標からの相対座標で，[x,y,z]の形で記述してください．
アドオン名は翻訳適用前の英数字の名前を記述してください．

a) スロープツール
書式 ... hm_slope_tl(スロープ形状, [設置座標])

スロープ形状は，以下のパラメータを利用できます．
hm_slope.UP, hm_slope.DOWN ... 1段上げる，1段下げる
hm_slope.E1, hm_slope.E2 ... 緩坂東向きスロープ，急坂東向きスロープ
hm_slope.W1, hm_slope.W2 ... 緩坂西向きスロープ，急坂西向きスロープ
hm_slope.N1, hm_slope.N2 ... 緩坂北向きスロープ，急坂北向きスロープ
hm_slope.S1, hm_slope.S2 ... 緩坂南向きスロープ，急坂南向きスロープ

例 ... hm_slope_tl(hm_slope.E1, [3,0,0])
↑相対座標(3,0,0)に緩坂東向きスロープを設置します．

b) 線路/道路建設ツール
書式 ... hm_way_tl("アドオン名",[起点座標],[終点座標])

線路/道路/運河など，waytypeに関わらず利用できます．
ctrlキーを押しながら線路建設をしたときの挙動になります．

例 ... hm_way_tl("np-wooden-sleeper-track",[4,0,0],[9,0,0])

c) 架線建設ツール
書式 ... hm_wayobj_tl("アドオン名",[起点座標],[終点座標])

このツールは，鉄道用架線でのみ利用できます．他のwaytypeでは利用できません．

例 ... hm_wayobj_tl("np-slow-overheadpower",[0,1,0],[13,1,2])

d) 駅建設ツール
書式 ... hm_station_tl("アドオン名",[設置座標])

鉄道用ホーム/道路用停留所など，waytypeに関わらず利用できます．

例 ... hm_station_tl("np-railstop-platform-1",[3,3,4])

e) 信号/標識設置ツール
書式 ... hm_sign_tl("アドオン名",ツール実行回数,[設置座標])

鉄道用信号/道路用標識など，waytypeに関わらず信号，標識ともに利用できます．
向きの設定は，手動で設置する時と同様にツールの実行回数により行います．

例 ... hm_sign_tl("np-rail-signals",3,[4,0,2])
この例では信号設置ツールを3回クリックすることになります．

f) 撤去ツール
書式 ... hm_remove_tl([撤去座標])

ワンクリックの撤去ツールです．挙動は手動で実行したときに準じます．

例 ... hm_remove_tl([9,6,0])

g) 線路/道路撤去ツール
書式 ... hm_wayremove_tl([起点座標],[終点座標])

起点座標にある線路や道路のwaytypeを見て，線路の撤去を行います．
起点および終点タイルの線路は残されます．

例 ... hm_wayremove_tl([3,0,1],[10,0,1])


5. 既知の問題
simutrans standard 122.0上で動作させたときに観測している問題です．
・ツールb, c, gにおいて，建設経路が見つからなかった場合でもエラーが出ません．
・ツールeを踏切（同じタイルに線路と道路がある）上で動作させると正しく動作しないことがあります．
将来のsimutrans本体の仕様変更により，本ライブラリの挙動が変わる可能性があります．
